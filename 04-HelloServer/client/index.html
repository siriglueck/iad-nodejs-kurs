<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Todos</title>
</head>
<body>
    <h1>todos</h1>
    <form id="formular">
        <input name="text" type="text" placeholder="Was steht an?">
    </form>
    <ul id="liste">

    </ul>
    <script>
        const url = 'http://localhost:3000/api/todos';
        const listElt = document.getElementById('liste');

        function getTodos() {
            fetch(url).then(resp => resp.json()).then(todos => {
                todos.forEach(todo => {
                    listElt.insertAdjacentHTML('beforeend', `<li>${todo.text}</li>`)
                })
            })
        }

        function addTodo(text) {
            fetch(url, { method: 'POST', body: text}).then(resp => resp.json()).then(todo => {
                listElt.insertAdjacentHTML('beforeend', `<li>${todo.text}</li>`)
            })
        }

        getTodos();
        document.getElementById('formular').addEventListener('submit', (ev) => {
            const data = new FormData(ev.target);
            const text = data.get('text');
            addTodo(text);
        });
    </script>
</body>
</html>